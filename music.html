<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>JS Music Player</title>
<style>
  :root{
    --bg:#0f1724; --card:#0b1220; --accent:#6ee7b7; --muted:#94a3b8; --glass:rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;}
  body{margin:0;min-height:100vh;background:linear-gradient(180deg,#071427 0%, #0b1726 100%);display:flex;align-items:center;justify-content:center;padding:24px;color:#e6eef6;}
  .player{width:100%;max-width:920px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;display:grid;grid-template-columns:300px 1fr;gap:16px;box-shadow:0 10px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03);}
  .cover{border-radius:10px;overflow:hidden;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:14px;background:var(--glass);}
  .cover img{width:100%;height:300px;object-fit:cover;border-radius:8px;box-shadow:0 6px 18px rgba(2,6,23,0.5);transition:transform .25s;}
  .cover img:hover{transform:scale(1.02)}
  .meta{margin-top:12px;text-align:center}
  .meta h3{margin:4px 0;font-size:18px}
  .meta p{margin:0;color:var(--muted);font-size:13px}
  .controls{display:flex;align-items:center;justify-content:center;gap:12px;margin-top:12px}
  .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:inherit;cursor:pointer;transition:transform .12s,background .12s}
  .btn:hover{transform:translateY(-3px);background:rgba(255,255,255,0.02)}
  .big{font-size:18px;padding:10px 14px}
  .play{background:linear-gradient(90deg,var(--accent),#43c6ff);color:#042018;border: none; box-shadow:0 8px 20px rgba(6,22,17,0.45)}
  .right{padding:8px 10px;display:flex;flex-direction:column;gap:12px}
  .progress-wrap{display:flex;align-items:center;gap:10px}
  .time{font-size:13px;color:var(--muted);min-width:44px;text-align:center}
  .progress{flex:1;height:10px;background:rgba(255,255,255,0.04);border-radius:10px;overflow:hidden;cursor:pointer;position:relative}
  .progress .bar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#3dd6ff);border-radius:10px;transition:width .08s linear}
  .sliders{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
  .slider{display:flex;align-items:center;gap:8px}
  input[type=range]{appearance:none;-webkit-appearance:none;height:6px;background:transparent;width:150px}
  input[type=range]::-webkit-slider-runnable-track{height:6px;background:rgba(255,255,255,0.06);border-radius:6px}
  input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:var(--accent);margin-top:-4px;box-shadow:0 4px 10px rgba(6,22,17,0.6)}
  .playlist{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;max-height:220px;overflow:auto}
  .track{display:flex;align-items:center;gap:12px;padding:8px;border-radius:8px;cursor:pointer;transition:background .12s}
  .track:hover{background:rgba(255,255,255,0.01)}
  .track.active{background:linear-gradient(90deg, rgba(110,231,183,0.08), rgba(61,214,255,0.04));border-left:3px solid var(--accent)}
  .track img{width:48px;height:48px;border-radius:6px;object-fit:cover}
  .track .info{flex:1}
  .small{font-size:13px;color:var(--muted)}
  .toprow{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .toggle{display:inline-flex;align-items:center;gap:8px;background:rgba(255,255,255,0.02);padding:6px 10px;border-radius:999px}
  @media (max-width:820px){.player{grid-template-columns:1fr;max-width:520px}.cover img{height:220px}}
</style>
</head>
<body>

<div class="player" id="player">
  <div class="cover">
    <img id="coverImg" src="covers/cover1.jpg" alt="cover">
    <div class="meta">
      <h3 id="title">Title</h3>
      <p id="artist">Artist</p>
    </div>

    <div class="controls">
      <button class="btn" id="prevBtn" title="Previous">⏮️</button>
      <button class="btn big play" id="playBtn" title="Play/Pause">▶️</button>
      <button class="btn" id="nextBtn" title="Next">⏭️</button>
    </div>

    <div style="width:100%;margin-top:12px">
      <div class="sliders">
        <div class="slider" style="align-items:center">
          <span class="small">Vol</span>
          <input id="vol" type="range" min="0" max="1" step="0.01" value="0.9">
        </div>
        <div class="toggle" style="margin-left:auto">
          <label class="small">Autoplay</label>
          <input id="autoplayToggle" type="checkbox" style="transform:scale(1.1)">
        </div>
      </div>
    </div>
  </div>

  <div class="right">
    <div class="toprow">
      <div style="display:flex;flex-direction:column">
        <div class="small">Now playing</div>
        <div style="font-weight:600" id="nowPlaying">—</div>
      </div>
      <div class="small" id="durationTotal">00:00</div>
    </div>

    <div class="progress-wrap" style="margin-top:8px">
      <div class="time" id="curTime">00:00</div>
      <div class="progress" id="progressBar" title="Seek">
        <div class="bar" id="progressBarFill"></div>
      </div>
      <div class="time" id="remTime">00:00</div>
    </div>

    <div class="playlist" id="playlist">
      <!-- tracks inserted by JS -->
    </div>

    <audio id="audio"></audio>
  </div>
</div>

<script>
/* ======= Tracks =======
Replace src values with your local files (e.g., "songs/song1.mp3")
or remote URLs. Provide matching cover images (covers/coverX.jpg).
*/
const tracks = [
  {src:'songs/song1.mp3', title:'Sunrise Drive', artist:'Aurora Sky', cover:'covers/cover1.jpg', durationText:''},
  {src:'songs/song2.mp3', title:'City Lights', artist:'Neon Tide', cover:'covers/cover2.jpg', durationText:''},
  {src:'songs/song3.mp3', title:'Midnight Coffee', artist:'Lo-Fi Dreams', cover:'covers/cover3.jpg', durationText:''}
];

const audio = document.getElementById('audio');
const playBtn = document.getElementById('playBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const vol = document.getElementById('vol');
const progressBar = document.getElementById('progressBar');
const progressBarFill = document.getElementById('progressBarFill');
const curTimeEl = document.getElementById('curTime');
const remTimeEl = document.getElementById('remTime');
const titleEl = document.getElementById('title');
const artistEl = document.getElementById('artist');
const coverImg = document.getElementById('coverImg');
const playlistEl = document.getElementById('playlist');
const autoplayToggle = document.getElementById('autoplayToggle');
const nowPlaying = document.getElementById('nowPlaying');
const durationTotal = document.getElementById('durationTotal');

let idx = 0;
let isPlaying = false;
let updateProgressRAF = null;

/* Utility: format seconds -> mm:ss */
function fmt(t){
  if (!isFinite(t)) return '00:00';
  const m = Math.floor(t/60);
  const s = Math.floor(t % 60);
  return String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
}

/* Load track metadata and set UI */
function loadTrack(i){
  idx = (i + tracks.length) % tracks.length;
  const t = tracks[idx];
  audio.src = t.src;
  titleEl.textContent = t.title;
  artistEl.textContent = t.artist;
  coverImg.src = t.cover || 'https://via.placeholder.com/400x400?text=Cover';
  nowPlaying.textContent = `${t.title} — ${t.artist}`;
  // update active class in playlist
  document.querySelectorAll('.track').forEach((el,ii)=> el.classList.toggle('active', ii===idx));
}

/* Play / Pause */
function play(){
  audio.play().then(()=>{isPlaying=true; playBtn.textContent='⏸️'; playBtn.classList.add('playing');})
    .catch(err => console.warn('Play failed',err));
  startProgress();
}
function pause(){
  audio.pause();
  isPlaying=false; playBtn.textContent='▶️'; playBtn.classList.remove('playing');
  cancelAnimationFrame(updateProgressRAF);
}

/* Next / Prev */
function nextTrack(){
  loadTrack(idx+1);
  if(isPlaying || autoplayToggle.checked) play(); else { pause(); audio.currentTime=0; }
}
function prevTrack(){
  // if >3s jump to start, else go prev
  if(audio.currentTime > 3) { audio.currentTime = 0; updateProgress(); return; }
  loadTrack(idx-1);
  if(isPlaying) play(); else pause();
}

/* Progress Updater (smooth) */
function startProgress(){
  function frame(){
    updateProgress();
    updateProgressRAF = requestAnimationFrame(frame);
  }
  updateProgressRAF = requestAnimationFrame(frame);
}
function updateProgress(){
  const cur = audio.currentTime || 0;
  const dur = audio.duration || 0;
  const percent = dur ? (cur/dur*100) : 0;
  progressBarFill.style.width = percent + '%';
  curTimeEl.textContent = fmt(cur);
  remTimeEl.textContent = dur ? fmt(dur - cur) : '00:00';
  durationTotal.textContent = dur ? fmt(dur) : '00:00';
}

/* Seek when clicking progress bar */
progressBar.addEventListener('click', (e)=>{
  const rect = progressBar.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const ratio = Math.max(0, Math.min(1, x / rect.width));
  if(audio.duration) audio.currentTime = ratio * audio.duration;
  updateProgress();
});

/* Volume control */
vol.addEventListener('input', ()=>{ audio.volume = vol.value; });

/* Audio events */
audio.addEventListener('timeupdate', updateProgress);
audio.addEventListener('ended', ()=>{
  if(autoplayToggle.checked) { nextTrack(); } else { pause(); audio.currentTime=0; }
});
audio.addEventListener('loadedmetadata', updateProgress);

/* Buttons */
playBtn.addEventListener('click', ()=> isPlaying ? pause() : play());
nextBtn.addEventListener('click', nextTrack);
prevBtn.addEventListener('click', prevTrack);

/* Keyboard shortcuts */
window.addEventListener('keydown', (e)=>{
  if(e.code === 'Space'){ e.preventDefault(); isPlaying? pause() : play(); }
  if(e.code === 'ArrowRight'){ nextTrack(); }
  if(e.code === 'ArrowLeft'){ prevTrack(); }
});

/* Build playlist UI and attach click handlers */
function buildPlaylist(){
  playlistEl.innerHTML = '';
  tracks.forEach((t,i)=>{
    const tr = document.createElement('div');
    tr.className = 'track';
    tr.innerHTML = `
      <img src="${t.cover || 'https://via.placeholder.com/100'}" alt="cover">
      <div class="info">
        <div style="font-weight:600">${t.title}</div>
        <div class="small">${t.artist}</div>
      </div>
      <div class="small" style="min-width:44px;text-align:right" data-i="${i}">--:--</div>
    `;
    tr.addEventListener('click', ()=>{ loadTrack(i); play(); });
    playlistEl.appendChild(tr);

    // prefetch duration for display (attempt)
    const a = document.createElement('audio');
    a.src = t.src;
    a.preload = 'metadata';
    a.addEventListener('loadedmetadata', ()=>{
      const secs = a.duration;
      const label = tr.querySelector('[data-i]');
      if(label) label.textContent = fmt(secs);
    });
  });
}

/* initial setup */
buildPlaylist();
loadTrack(0);
audio.volume = vol.value;

/* optional: preload audio metadata for all tracks to show duration (already attempted above)
   If you use remote URLs from cross-origin without CORS headers, metadata may not load — in that case
   durations will show --:--. */

/* small UX: click play on title double click */
titleEl.addEventListener('dblclick', ()=> isPlaying? pause() : play());

</script>
</body>
</html>